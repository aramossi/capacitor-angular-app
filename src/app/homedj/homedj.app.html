<div class="homedj-background">
    <!-- Men√∫ de botones modernos compactos -->
    <nav class="top-bar-menu">
        <div class="dj-perfil-menu">
            <button class="modern-back-btn" (click)="irHome()" title="Principal">
                <span class="menu-icon">üè†</span>
                <span class="menu-text">Principal</span>
            </button>
            <button class="modern-back-btn" (click)="irPerfil()" title="Mi perfil">
                <span class="menu-icon">üë§</span>
                <span class="menu-text">Mi perfil</span>
            </button>
            <button class="modern-back-btn" (click)="irNotificaciones()" title="Notificaciones">
                <span class="menu-icon">üîî</span>
                <span class="menu-text">Notificaciones</span>
            </button>
            <button class="modern-back-btn" (click)="cerrarSesion()" title="Cerrar sesi√≥n">
                <span class="menu-icon">‚èª</span>
                <span class="menu-text">Cerrar sesi√≥n</span>
            </button>
        </div>
    </nav>

    <!-- Icono de carga mientras se obtienen los datos -->
    <div *ngIf="cargando" style="text-align:center; margin:2rem;">
        <span style="font-size:2.5rem;">‚è≥</span>
        <div>Cargando datos...</div>
    </div>

    <!-- Layout principal solo si ya carg√≥ -->
    <div *ngIf="!cargando" class="dj-layout">
        <div class="dj-main-content">
            <div class="calendar-container">
                <!-- Encabezado con t√≠tulo -->
                <header class="calendar-header">
                    <h2>Mi Calendario</h2>
                </header>
                <!-- Secci√≥n del calendario: muestra el mes, d√≠as y permite seleccionar disponibilidad -->
                <div class="calendar-section">
                    <!-- Mockup visual del calendario (puedes reemplazar por un componente real) -->
                    <div class="calendar-mockup">
                        <!-- Encabezado del mes con flechas para navegar -->
                        <div class="calendar-month">
                            <button class="month-arrow" (click)="cambiarMes(-1)">&#8592;</button>
                            {{ meses[mes] }} {{ anio }}
                            <button class="month-arrow" (click)="cambiarMes(1)">&#8594;</button>
                        </div>
                        <!-- Grid de d√≠as de la semana y d√≠as del mes -->
                        <div class="calendar-grid">
                            <!-- Etiquetas de los d√≠as de la semana -->
                            <div class="calendar-day-label" *ngFor="let d of diasSemana">{{d}}</div>
                            <!-- D√≠as del mes generados din√°micamente -->
                            <ng-container *ngFor="let day of diasMes">
                                <div [ngClass]="getDayClass(day)" class="calendar-day" (click)="pintarDia(day)">
                                    <ng-container *ngIf="day">{{day.num}}</ng-container>
                                </div>
                            </ng-container>
                        </div>
                    </div>
                    <!-- Leyenda para seleccionar el estado del d√≠a -->
                    <div class="calendar-legend">
                        <span class="legend available" [class.selected]="estadoSeleccionado==='available'"
                            (click)="seleccionarEstado('available')">Disponible</span>
                        <span class="legend busy" [class.selected]="estadoSeleccionado==='busy'"
                            (click)="seleccionarEstado('busy')">Ocupado</span>
                        <span class="legend tentative" [class.selected]="estadoSeleccionado==='tentative'"
                            (click)="seleccionarEstado('tentative')">Propuesta</span>
                    </div>
                    <!-- Formulario de agenda para d√≠as ocupados y propuestas -->
                    <div *ngIf="agendaFormVisible" class="agenda-form">
                        <h4>{{agendaTipoFormulario === 'busy' ? 'Registrar agenda para' : 'Registrar propuesta para'}}
                            {{agendaFecha}}</h4>
                        <input *ngIf="agendaTipoFormulario === 'busy'" [(ngModel)]="agendaDireccion"
                            placeholder="Direcci√≥n" class="edit-input" />
                        <input [(ngModel)]="agendaPersona" placeholder="Persona a contactar" class="edit-input" />
                        <input [(ngModel)]="agendaTelefono" placeholder="Tel√©fono" class="edit-input" />
                        <textarea [(ngModel)]="agendaDescripcion" placeholder="Descripci√≥n breve" class="edit-input"
                            rows="3"></textarea>
                        <div class="agenda-form-buttons">
                            <button (click)="guardarAgenda()">Guardar</button>
                            <button (click)="agendaFormVisible=false">Cancelar</button>
                        </div>
                    </div>
                </div>
                <!-- Secci√≥n de gesti√≥n de paquetes de servicio del DJ -->
                <section class="service-section">
                    <!-- Encabezado con t√≠tulo y bot√≥n para agregar un nuevo paquete -->
                    <div class="service-header">
                        <h3>Mis Paquetes de Servicio</h3>
                        <button class="add-service-btn" (click)="agregarPaquete()">+</button>
                    </div>
                    <!-- Lista de paquetes de servicio -->
                    <div class="service-list">
                        <!-- Cada tarjeta representa un paquete de servicio -->
                        <div class="service-card" *ngFor="let paquete of paquetes; let i = index">
                            <!-- Icono del paquete -->
                            <span class="service-icon">{{paquete.icon}}</span>
                            <!-- Informaci√≥n editable del paquete -->
                            <div class="service-info">
                                <div class="service-title">
                                    <!-- Si est√° en modo edici√≥n, muestra input; si no, solo el texto -->
                                    <ng-container *ngIf="editando === i; else noedit">
                                        <input [(ngModel)]="paquete.titulo" class="edit-input"
                                            placeholder="T√≠tulo del paquete" title="T√≠tulo del paquete" />
                                    </ng-container>
                                    <ng-template #noedit>{{paquete.titulo}}</ng-template>
                                </div>
                                <div class="service-price">
                                    <!-- Si est√° en modo edici√≥n, muestra input; si no, solo el texto -->
                                    <ng-container *ngIf="editando === i; else noeditp">
                                        <input [(ngModel)]="paquete.precio" class="edit-input" placeholder="Precio"
                                            title="Precio" />
                                    </ng-container>
                                    <ng-template #noeditp>{{paquete.precio}}</ng-template>
                                </div>
                                <div class="service-description">
                                    <!-- Si est√° en modo edici√≥n, muestra textarea; si no, solo el texto -->
                                    <ng-container *ngIf="editando === i; else noeditd">
                                        <textarea [(ngModel)]="paquete.descripcion" class="edit-input"
                                            placeholder="Descripci√≥n del paquete"></textarea>
                                    </ng-container>
                                    <ng-template #noeditd>
                                        <span class="description-text">{{paquete.descripcion || 'Sin
                                            descripci√≥n'}}</span>
                                    </ng-template>
                                </div>
                            </div>
                            <!-- Acciones: editar, eliminar, guardar -->
                            <div class="service-actions">
                                <span class="edit-icon" (click)="editarPaquete(i)">‚úèÔ∏è</span>
                                <button class="delete-btn" (click)="eliminarPaquete(i)">üóëÔ∏è</button>
                                <button *ngIf="editando === i" class="save-btn"
                                    (click)="guardarPaquete()">Guardar</button>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </div>
    </div>
</div>